"use strict";function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _get=function(e,t,i){for(var n=!0;n;){var o=e,s=t,l=i;r=d=a=void 0,n=!1,null===o&&(o=Function.prototype);var r=Object.getOwnPropertyDescriptor(o,s);if(void 0!==r){if("value"in r)return r.value;var a=r.get;if(void 0===a)return;return a.call(l)}var d=Object.getPrototypeOf(o);if(null===d)return;e=d,t=s,i=l,n=!0}},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Parallax=function(){function e(t){_classCallCheck(this,e),this.items=[],this.activeItems=[],this.scrollPos=0,this.windowHeight=window.innerHeight;for(var i=0;i<t.length;i++){var n={id:i,obj:t[i],speed:t[i].dataset.speed,step:0};this.items.push(n)}this.bindUIActions(),this.update(),this.render()}return _createClass(e,[{key:"update",value:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e].obj.getBoundingClientRect().top,i=this.items[e].obj.getBoundingClientRect().bottom;t-500<this.windowHeight&&i>0?this.activeItems[this.items[e].id]=this.items[e]:this.activeItems[this.items[e].id]&&this.activeItems.splice(this.items[e].id)}}},{key:"render",value:function(){self=this,Array.prototype.forEach.call(this.activeItems,function(e){var t=e.obj.getBoundingClientRect().height/2-e.obj.getBoundingClientRect().top,i=100*t/self.windowHeight*e.speed,n="translateY("+i.toFixed(2)+"px)";e.obj.style.transform=n,e.obj.style.webkitTransform=n,e.obj.style.mozTransform=n,e.obj.style.msTransform=n}),requestAnimationFrame(this.render.bind(this))}},{key:"bindUIActions",value:function(){var e=this;window.onscroll=function(){e.scrollPos=document.documentElement.scrollTop||document.body.scrollTop,e.update()}}}]),e}(),Slider=function(){function e(t,i,n,o,s){_classCallCheck(this,e),this.wrapper=t,this.slides=i,this.speed=n,this.auto=o,this.mode=s,this.slider=null,this.initSlider(),this.bindUIActions()}return _createClass(e,[{key:"initSlider",value:function(){var e=this;this.slider=this.wrapper.bxSlider({mode:this.mode,speed:this.speed,pause:7e3,controls:!1,auto:this.auto,autoControls:!1,autoControlsCombine:!1,pager:!1,touchEnabled:!0,adaptiveHeight:!0,responsive:!0,onSlideBefore:function(t){e.onSlideBefore(t)},onSlideAfter:function(t,i,n){e.onSlideAfter(t,i,n)},onSliderLoad:function(){e.onSliderLoad()}})}},{key:"onSlideBefore",value:function(){TweenMax.staggerTo(".current-slide .tween-side",1,{x:"20%",opacity:0,ease:Power2.easeInOut},.2),$(".pager-slider").addClass("active")}},{key:"onSlideAfter",value:function(e,t,i){this.sendEvent(i),this.updatePager(t,i),$(".item-detail").removeClass("current-slide"),e.addClass("current-slide"),TweenMax.set(".current-slide .tween-side",{clearProps:"transform"}),TweenMax.staggerTo(".current-slide .tween-side",1.5,{x:"0%",opacity:1,delay:.5,ease:Power2.easeInOut},.2),setTimeout(function(){$(".pager-slider").removeClass("active")},4e3)}},{key:"onSliderLoad",value:function(){TweenMax.set(".current-slide .tween-side",{clearProps:"transform"}),TweenMax.staggerTo(".current-slide .tween-side",1.5,{x:"0%",opacity:1,delay:.5,ease:Power2.easeInOut},.2)}},{key:"goTo",value:function(e){this.slider.goToSlide(e)}},{key:"prev",value:function(e){e.preventDefault(),this.slider.goToPrevSlide(),this.slider.stopAuto()}},{key:"next",value:function(e){e.preventDefault(),this.slider.goToNextSlide(),this.slider.stopAuto()}},{key:"updatePager",value:function(e,t){var i=document.getElementById("prev"),n=document.getElementById("next");e=parseInt(e),t=parseInt(t),i.innerHTML="0"+e,n.innerHTML="0"+t}},{key:"sendEvent",value:function(e){var t=new CustomEvent("nextSlide",{detail:{pointer:e},bubbles:!0,cancelable:!1});document.dispatchEvent(t)}},{key:"bindUIActions",value:function(){var e=document.getElementById("prev"),t=document.getElementById("next");e.addEventListener("click",this.prev.bind(this),!1),t.addEventListener("click",this.next.bind(this),!1)}}]),e}(),ScreenSlider=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"onSlideBefore",value:function(){}},{key:"onSlideAfter",value:function(){}},{key:"onSliderLoad",value:function(){}}]),t}(Slider),Map=function(){function e(t){_classCallCheck(this,e),self=this,this.zoom=15,this.latLng={lat:45.896,lng:6.128},this.map=new google.maps.Map(document.getElementById("gmap"),{center:self.latLng,scrollwheel:!1,zoom:parseInt(self.zoom),styles:self.getStyle(),disableDefaultUI:!0}),this.infowindow=new InfoBubble({map:this.map,content:"coucou info view",shadowStyle:0,padding:20,backgroundColor:"#fb224b",borderRadius:0,arrowSize:0,arrowPosition:0,borderWidth:0,disableAutoPan:!0,hideCloseButton:!0,backgroundClassName:"info-bubble",arrowStyle:0,minWidth:150,minHeight:150});for(var i=0;i<t.length;i++)this.addMarker(t[i]);this.bindUIActions()}return _createClass(e,[{key:"zoomIn",value:function(e){e.preventDefault(),this.zoom=this.zoom+1,this.map.setZoom(this.zoom)}},{key:"zoomOut",value:function(e){e.preventDefault(),this.zoom=this.zoom-1,this.map.setZoom(this.zoom)}},{key:"addMarker",value:function(e){self=this;var t=new google.maps.Marker({position:e.latLng,map:self.map,icon:"tpl/img/marker1.png",data:{title:e.title,time:e.time,place:e.location}});t.addListener("click",function(){this.showInfo(t)}.bind(this),!1)}},{key:"showInfo",value:function(e){console.log(e),this.infowindow.setContent('<h4 class="title-infobubble">'+e.data.title+'</h4><p class="time-infobubble">'+e.data.time+'</p><p class="location-infobubble">'+e.data.place+'</p><a href="#" class="link-infobubble">Voir le replay</a>'),this.infowindow.open(self.map,e)}},{key:"getStyle",value:function(){return[{featureType:"administrative",elementType:"all",stylers:[{color:"#0200fd"},{visibility:"on"},{weight:"1"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#0200fd"},{weight:"1.30"},{visibility:"on"}]},{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#000181"},{visibility:"simplified"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45},{color:"#0c005f"},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#0200ff"},{visibility:"on"}]}]}},{key:"bindUIActions",value:function(){var e=document.getElementById("zoom-in"),t=document.getElementById("zoom-out");e.addEventListener("click",this.zoomIn.bind(this),!1),t.addEventListener("click",this.zoomOut.bind(this),!1)}}]),e}(),store,app={store:{screenSlider:""},init:function(){store=this.store,this.bindUI();var e=document.getElementsByClassName("parallax"),t=(new Parallax(e),$("#slider-1")),i=$(".item-detail"),n=(new Slider(t,i,0,!0,"fade"),$("#slider-2")),o=$(".item-screen");store.screenSlider=new ScreenSlider(n,o,1e3,!1,"fade"),document.addEventListener("nextSlide",this.updateSliders,!1)},initMap:function(){var e=[{id:0,title:"Louise Roam",time:"12/07/2015",location:"Le Brise Glace",latLng:{lat:45.896,lng:6.128}},{id:1,title:"Nekfeu",time:"20/05/2015",location:"CCI",latLng:{lat:45.893514,lng:6.135523}}];new Map(e)},updateSliders:function(e){var t=e.detail.pointer;store.screenSlider.goTo(t)},bindUI:function(){$("body").keypress(function(){119==event.which&&(event.preventDefault(),$("body").toggleClass("dev"))})}};app.init();
